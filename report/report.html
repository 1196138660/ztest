<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试报告</title>
    <link href="css/bootstrap.min.css?v=3.3.5" rel="stylesheet">
    <link href="css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
    <link href="css/plugins/iCheck/custom.css" rel="stylesheet">
    <link href="css/animate.min.css" rel="stylesheet">
    <link href="css/style.min.css?v=4.0.0" rel="stylesheet">
    <base target="_blank">
</head>
<body class="gray-bg">
<div class="row  border-bottom white-bg dashboard-header">
    <div class="col-sm-12 text-center">
        <span style="color: #1ab394; font-size: 20px; font-weight: 700">测试报告</span>
    </div>
</div>
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>报告汇总</h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-sm-6 b-r" style="height:350px">
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label text-navy">用例名称:</label>
                                    <div class="col-sm-5">
                                        <span class="form-control" id="testName"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label text-navy">用例总数:</label>
                                    <div class="col-sm-5">
                                        <span class="form-control" id="testAll"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label text-navy">用例通过:</label>
                                    <div class="col-sm-5">
                                        <span class="form-control" id="testPass"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label text-danger">用例失败:</label>
                                    <div class="col-sm-5">
                                        <span class="form-control text-danger" id="testFail"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label text-warning">用例跳过:</label>
                                    <div class="col-sm-5">
                                        <span class="form-control text-warning" id="testSkip"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label text-navy">开始时间:</label>
                                    <div class="col-sm-5">
                                        <span class="form-control" id="beginTime"></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label text-navy">运行时间:</label>
                                    <div class="col-sm-5">
                                        <span class="form-control" id="totalTime"></span>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="col-sm-6">
                            <div style="height:350px" id="echarts-map-chart"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>详细数据</h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content">
                    <table class="table table-bordered">
                        <thead>
                        <tr>
                            <th>编号</th>
                            <th>测试类</th>
                            <th>测试方法</th>
                            <th>运行时长</th>
                            <th>结果</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody id="detailBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="js/jquery.min.js?v=2.1.4"></script>
<script src="js/bootstrap.min.js?v=3.3.5"></script>
<script src="js/content.min.js?v=1.0.0"></script>
<script src="js/plugins/iCheck/icheck.min.js"></script>
<script src="js/plugins/echarts/echarts.min.js"></script>
<script type="text/javascript">
    var resultData = {"testPass":1,"testResult":[{"className":"com.test.testcase.TestDemo1","methodName":"testDemo","spendTime":"5ms","status":"失败","log":["this is demo!","java.lang.ArithmeticException: / by zero","    com.test.testcase.TestDemo1.testDemo(TestDemo1.java:28)","    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)","    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)","    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)","    java.lang.reflect.Method.invoke(Method.java:606)","    org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:84)","    org.testng.internal.Invoker.invokeMethod(Invoker.java:714)","    org.testng.internal.Invoker.invokeTestMethod(Invoker.java:901)","    org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1231)","    org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:127)","    org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)","    org.testng.TestRunner.privateRun(TestRunner.java:767)","    org.testng.TestRunner.run(TestRunner.java:617)","    org.testng.SuiteRunner.runTest(SuiteRunner.java:334)","    org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)","    org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)","    org.testng.SuiteRunner.run(SuiteRunner.java:240)","    org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)","    org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)","    org.testng.TestNG.runSuitesSequentially(TestNG.java:1224)","    org.testng.TestNG.runSuitesLocally(TestNG.java:1149)","    org.testng.TestNG.run(TestNG.java:1057)","    org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)","    org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)","    org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175)"]},{"className":"com.test.testcase.TestDemo1","methodName":"testDemo1","spendTime":"3ms","status":"失败","log":["this is demo!","java.lang.AssertionError: should be equals. expected [b] but found [a]","    org.testng.Assert.fail(Assert.java:94)","    org.testng.Assert.failNotEquals(Assert.java:494)","    org.testng.Assert.assertEquals(Assert.java:123)","    org.testng.Assert.assertEquals(Assert.java:176)","    com.test.testcase.TestDemo1.testDemo1(TestDemo1.java:36)","    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)","    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)","    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)","    java.lang.reflect.Method.invoke(Method.java:606)","    org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:84)","    org.testng.internal.Invoker.invokeMethod(Invoker.java:714)","    org.testng.internal.Invoker.invokeTestMethod(Invoker.java:901)","    org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1231)","    org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:127)","    org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)","    org.testng.TestRunner.privateRun(TestRunner.java:767)","    org.testng.TestRunner.run(TestRunner.java:617)","    org.testng.SuiteRunner.runTest(SuiteRunner.java:334)","    org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)","    org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)","    org.testng.SuiteRunner.run(SuiteRunner.java:240)","    org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)","    org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)","    org.testng.TestNG.runSuitesSequentially(TestNG.java:1224)","    org.testng.TestNG.runSuitesLocally(TestNG.java:1149)","    org.testng.TestNG.run(TestNG.java:1057)","    org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)","    org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)","    org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175)"]},{"className":"com.test.testcase.TestDemo1","methodName":"testDemo2","spendTime":"1ms","status":"成功","log":["this is demo!"]},{"className":"com.test.testcase.TestDemo1","methodName":"testDemo2","spendTime":"1ms","status":"失败","log":["this is demo!","java.lang.AssertionError: should be equals. expected [1] but found [2]","    org.testng.Assert.fail(Assert.java:94)","    org.testng.Assert.failNotEquals(Assert.java:494)","    org.testng.Assert.assertEquals(Assert.java:123)","    org.testng.Assert.assertEquals(Assert.java:370)","    com.test.testcase.TestDemo1.testDemo2(TestDemo1.java:42)","    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)","    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)","    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)","    java.lang.reflect.Method.invoke(Method.java:606)","    org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:84)","    org.testng.internal.Invoker.invokeMethod(Invoker.java:714)","    org.testng.internal.Invoker.invokeTestMethod(Invoker.java:901)","    org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1231)","    org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:127)","    org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)","    org.testng.TestRunner.privateRun(TestRunner.java:767)","    org.testng.TestRunner.run(TestRunner.java:617)","    org.testng.SuiteRunner.runTest(SuiteRunner.java:334)","    org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)","    org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)","    org.testng.SuiteRunner.run(SuiteRunner.java:240)","    org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)","    org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)","    org.testng.TestNG.runSuitesSequentially(TestNG.java:1224)","    org.testng.TestNG.runSuitesLocally(TestNG.java:1149)","    org.testng.TestNG.run(TestNG.java:1057)","    org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)","    org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)","    org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175)"]},{"className":"com.test.testcase.TestDemo1","methodName":"beforeMethod","spendTime":"0ms","status":"失败","log":["java.lang.ArithmeticException: / by zero","    com.test.testcase.TestDemo1.beforeMethod(TestDemo1.java:20)","    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)","    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)","    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)","    java.lang.reflect.Method.invoke(Method.java:606)","    org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:84)","    org.testng.internal.Invoker.invokeConfigurationMethod(Invoker.java:564)","    org.testng.internal.Invoker.invokeConfigurations(Invoker.java:213)","    org.testng.internal.Invoker.invokeMethod(Invoker.java:653)","    org.testng.internal.Invoker.invokeTestMethod(Invoker.java:901)","    org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1231)","    org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:127)","    org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)","    org.testng.TestRunner.privateRun(TestRunner.java:767)","    org.testng.TestRunner.run(TestRunner.java:617)","    org.testng.SuiteRunner.runTest(SuiteRunner.java:334)","    org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)","    org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)","    org.testng.SuiteRunner.run(SuiteRunner.java:240)","    org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)","    org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)","    org.testng.TestNG.runSuitesSequentially(TestNG.java:1224)","    org.testng.TestNG.runSuitesLocally(TestNG.java:1149)","    org.testng.TestNG.run(TestNG.java:1057)","    org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)","    org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)","    org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175)"]},{"className":"com.test.testcase.TestDemo1","methodName":"testDemo3","spendTime":"1ms","status":"跳过","log":[]}],"testName":"20171109125639789","testAll":5,"testFail":3,"beginTime":"2017-11-09 12:56:39.819","totalTime":"11ms","testSkip":1};
    function details(obj) {
        if ($(obj).text() == '展开') {
            var len = $(obj).parent().parent().children().length;
            var detailLog = "";
            var logs = resultData["testResult"][parseInt($(obj).attr("buttonIndex"))]["log"];
            $(obj).text("收缩");
            $(obj).removeClass("btn-primary");
            $(obj).addClass("btn-danger");
            $.each(logs, function (i, n) {
                detailLog = detailLog + "<p>" + n + "</p>";
            });
            $(obj).parent().parent().after("<tr><td colspan='" + len + "'><div style='font-family: Consolas;font-size:12px'>" + detailLog + "</div></td></tr>");
        } else if ($(obj).text() == '收缩') {
            $(obj).parent().parent().next().remove();
            $(obj).text("展开");
            $(obj).removeClass("btn-danger");
            $(obj).addClass("btn-primary");
        }

    }
    $(function () {
        $("#testName").text(resultData["testName"]);
        $("#testPass").text(resultData["testPass"]);
        $("#testFail").text(resultData["testFail"]);
        $("#testSkip").text(resultData["testSkip"]);
        $("#testAll").text(resultData["testAll"]);
        $("#beginTime").text(resultData["beginTime"]);
        $("#totalTime").text(resultData["totalTime"]);
        $.each(resultData["testResult"], function (i, n) {
            var status = "";
            if (n["status"] == '成功') {
                status = "<td><span class='text-navy'>成功</span></td>";
            } else if (n["status"] == '失败') {
                status = "<td><span class='text-danger'>失败</span></td>";
            } else if (n["status"] == '跳过') {
                status = "<td><span class='text-warning'>跳过</span></td>";
            } else {
                status = "<td><span>" + n["status"] + "</span></td>";
            }
            var tr = "<tr style='font-family: Consolas'><td>" + (i + 1) + "</td><td>" + n["className"] + "</td><td>" + n["methodName"] + "</td><td>" + n["spendTime"] + "</td>" +
                status + "<td><button type='button' onclick='details(this)' buttonIndex='" + i + "' class='btn btn-primary btn-xs' style='margin-bottom: 0px'>展开</button></td></tr>"
            $("#detailBody").append(tr);
        });

        function pie() {
            var option = {
                title: {
                    text: '测试用例运行结果',
                    subtext: '',
                    x: 'center'
                },
                tooltip: {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                legend: {
                    orient: 'vertical',
                    left: 'left',
                    data: ['失败', '跳过', '成功']
                },
                series: [
                    {
                        name: '运行结果',
                        type: 'pie',
                        radius: '55%',
                        center: ['50%', '60%'],
                        data: [
                            {value: resultData["testFail"], name: '失败'},
                            {value: resultData["testSkip"], name: '跳过'},
                            {value: resultData["testPass"], name: '成功'}
                        ],
                        itemStyle: {
                            emphasis: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }
                ]
            };
            var chart = echarts.init(document.getElementById("echarts-map-chart"));
            chart.setOption(option);
        }
        pie();
    });

</script>
</body>
</html>